<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Tableau de Bord - Plateforme Agricole</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: linear-gradient(to bottom right, #e0f7fa, #ffffff);
            font-family: "Poppins", sans-serif;
        }

        header {
            background-color: #4FC3F7;
            color: white;
            padding: 20px 0;
            font-size: 1.8em;
            font-weight: 600;
            text-align: center;
        }

        nav a {
            margin: 0 10px;
        }

        main {
            max-width: 800px;
            margin: 50px auto;
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        footer {
            text-align: center;
            color: #555;
            margin-top: 40px;
            padding: 20px 0;
        }

        .meteo {
            background: linear-gradient(135deg, #81D4FA, #E1F5FE);
            border: none;
            color: #004D40;
        }

        .meteo strong {
            color: #0277BD;
        }
    </style>
</head>

<body>

<!-- En-tête -->
<header>🌦 Tableau de Bord Administrateur</header>

<!-- Barre de navigation -->
<nav class="navbar navbar-expand-lg bg-light shadow-sm">
    <div class="container justify-content-center">
        <a href="/home" class="btn btn-primary mx-2">🏠 Accueil</a>
        <a href="/auth/logout" class="btn btn-danger mx-2">🚪 Déconnexion</a>
    </div>
</nav>

<!-- Contenu principal -->
<main>
    <div class="card p-4 mb-4">
        <h2 class="text-center mb-4">📊 Statistiques Générales</h2>
        <ul class="list-group list-group-flush fs-5">
            <li class="list-group-item">👤 Utilisateurs : <strong th:text="${nbUtilisateurs}">12</strong></li>
            <li class="list-group-item">🛰 Capteurs : <strong th:text="${nbCapteurs}">5</strong></li>
            <li class="list-group-item">🛒 Commandes : <strong th:text="${nbCommandes}">8</strong></li>
        </ul>
    </div>

    <div class="card p-4 meteo text-center">
        <h2 class="mb-3">🌤 Météo en temps réel à Matam</h2>
        <p>Température : <strong id="temp">--°C</strong></p>
        <p>Description : <strong id="desc">Chargement...</strong></p>
    </div>
</main>

<!-- Pied de page -->
<footer>
    © 2025 - Plateforme Agricole
</footer>

<script>
    const apiKey = "91a421e86c57cd1309cb65e78e8d673a";
    const city = "Matam";

    async function getWeather() {
        try {
            const res = await fetch(https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=fr);
            const data = await res.json();
            document.getElementById("temp").textContent = Math.round(data.main.temp) + "°C";
            document.getElementById("desc").textContent = data.weather[0].description;
        } catch (e) {
            document.getElementById("temp").textContent = "--°C";
            document.getElementById("desc").textContent = "Erreur de chargement";
        }
    }

    getWeather();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>