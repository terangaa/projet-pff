<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="head :: head"></head>
<body class="bg-light">

<!-- Bouton Retour -->
<div class="container mt-4">
    <a th:href="@{/dashboard}" class="btn btn-secondary d-inline-flex align-items-center gap-2 shadow-sm">
        <i class="bi bi-arrow-left fs-5"></i>
        Retour au Dashboard
    </a>
</div>

<!-- Titre -->
<h1 class="text-center my-4 display-5 fw-bold text-dark">Liste des utilisateurs</h1>

<!-- Bouton Créer un utilisateur -->
<div class="container mb-4 text-end">
    <a th:href="@{/utilisateurs/creer}" class="btn btn-gradient-primary d-flex align-items-center gap-2 shadow-sm">
        <i class="bi bi-plus-lg fs-5"></i> Créer un nouvel utilisateur
    </a>
</div>

<!-- Cards utilisateurs / Message si vide -->
<div class="container">
    <div class="row g-4 justify-content-center">
        <!-- Message si liste vide -->
        <div th:if="${#lists.isEmpty(utilisateurs)}" class="col-12">
            <div class="alert alert-info text-center fw-semibold">
                Aucun utilisateur trouvé.
            </div>
        </div>

        <!-- Cards utilisateurs -->
        <div class="col-lg-3 col-md-4 col-sm-6 col-12" th:each="u : ${utilisateurs}">
            <div class="user-card p-3 rounded-4 shadow-sm d-flex flex-column">
                <div class="d-flex align-items-center mb-3">
                    <i class="bi bi-person-circle fs-1 text-primary me-3 icon-hover"></i>
                    <div class="text-truncate">
                        <h5 class="fw-semibold mb-1" th:text="${u.nom}">Nom utilisateur</h5>
                        <p class="text-muted mb-1" th:text="${u.email}">email@example.com</p>

                        <span class="badge role-badge" th:switch="${u.role}">
                            <span th:case="'ADMIN'" class="badge-gradient-admin" th:text="${u.role}">ADMIN</span>
                            <span th:case="'AGRICULTEUR'" class="badge-gradient-agriculteur" th:text="${u.role}">AGRICULTEUR</span>
                            <span th:case="'ACHETEUR'" class="badge-gradient-acheteur" th:text="${u.role}">ACHETEUR</span>
                            <span th:case="*" class="badge-gradient-default" th:text="${u.role}">ROLE</span>
                        </span>
                    </div>
                </div>

                <div class="d-flex flex-column flex-sm-row gap-2 mt-auto flex-wrap">
                    <a th:href="@{/utilisateurs/detail/{id}(id=${u.id})}" class="btn btn-info d-flex align-items-center justify-content-center gap-1">
                        <i class="bi bi-eye"></i> Détail
                    </a>
                    <a th:href="@{/utilisateurs/modifier/{id}(id=${u.id})}" class="btn btn-warning d-flex align-items-center justify-content-center gap-1">
                        <i class="bi bi-pencil-square"></i> Modifier
                    </a>
                    <a th:href="@{/utilisateurs/supprimer/{id}(id=${u.id})}" class="btn btn-danger d-flex align-items-center justify-content-center gap-1"
                       onclick="return confirm('Voulez-vous vraiment supprimer cet utilisateur ?');">
                        <i class="bi bi-trash"></i> Supprimer
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<footer th:replace="footer :: footer"></footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- CSS personnalisé -->
<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(to bottom, #e0f7fa, #f0f4f8);
    }

    /* Glassmorphism cards */
    .user-card {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255,255,255,0.25);
        transition: transform 0.5s ease, box-shadow 0.5s ease;
        display: flex;
        flex-direction: column;
    }
    .user-card:hover {
        transform: translateY(-10px) scale(1.02);
        box-shadow: 0 25px 40px rgba(0,0,0,0.12);
    }

    /* Icon hover */
    .icon-hover {
        transition: transform 0.4s ease, color 0.3s ease;
    }
    .icon-hover:hover {
        transform: scale(1.3) rotate(5deg);
        color: #6610f2;
    }

    /* Gradient badges */
    .badge {
        font-weight: 600;
        padding: 0.35em 0.85em;
        border-radius: 50px;
        color: #fff;
        display: inline-block;
        margin-top: 4px;
        opacity: 0;
        transform: translateY(-12px);
        animation: fadeInUp 0.7s forwards;
    }
    .badge-gradient-admin { background: linear-gradient(45deg, #ff4d4d, #ff1a1a); }
    .badge-gradient-agriculteur { background: linear-gradient(45deg, #28a745, #198754); }
    .badge-gradient-acheteur { background: linear-gradient(45deg, #0d6efd, #0a58ca); }
    .badge-gradient-default { background: linear-gradient(45deg, #6c757d, #495057); }

    @keyframes fadeInUp {
        to { opacity: 1; transform: translateY(0); }
    }

    /* Gradient buttons */
    .btn-gradient-primary {
        background: linear-gradient(135deg, #0d6efd, #6610f2);
        color: #fff;
        transition: background 0.4s, transform 0.3s;
    }
    .btn-gradient-primary:hover {
        background: linear-gradient(135deg, #6610f2, #0d6efd);
        transform: translateY(-2px);
    }

    /* Boutons cards flex */
    .user-card .btn {
        min-width: 0;
        flex: 1 1 calc(33.333% - 0.5rem);
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .user-card {
            padding: 1.5rem;
        }
        .user-card .btn {
            flex: 1 1 100%;
        }
    }
</style>
</body>
</html>
