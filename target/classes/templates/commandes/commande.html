<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste des Commandes</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        h1 {
            color: #343a40;
            font-weight: 600;
        }
        .table thead {
            background-color: #343a40;
            color: #fff;
        }
        .table tbody tr:hover {
            background-color: #e9ecef;
        }
        .container {
            max-width: 1000px;
        }
    </style>
</head>
<body class="container mt-5">

<h1 class="mb-4 text-center">üì¶ Liste des Commandes</h1>

<!-- Boutons Ajouter et Retour -->
<div class="d-flex justify-content-between mb-4">
    <!-- Bouton Retour -->
    <a href="/dashboard" class="btn btn-outline-secondary shadow-sm rounded">
        ‚¨ÖÔ∏è Retour
    </a>

    <!-- Bouton Ajouter -->
    <a href="/commandes/nouvelle" class="btn btn-success shadow-sm rounded">
        ‚ûï Ajouter une commande
    </a>
</div>

<div class="table-responsive shadow-sm rounded">
    <table class="table table-striped table-hover align-middle">
        <thead>
        <tr>
            <th>ID</th>
            <th>Client</th>
            <th>Produit Command√©</th>
            <th>Date de Commande</th>
            <th>Prix Total</th>
            <th class="text-center">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="commande : ${commandes}">
            <td th:text="${commande.id}"></td>
            <td th:text="${commande.acheteur.prenom != null ? commande.acheteur.nom + ' ' + commande.acheteur.prenom : commande.acheteur.nom}"></td>
            <td th:text="${commande.produit.nom}"></td>
            <td th:text="${#temporals.format(commande.dateCommande, 'dd/MM/yyyy HH:mm')}"></td>
            <td th:text="${commande.prixTotal} + ' FCFA'"></td>
            <td class="text-center">
                <!-- Boutons actions -->
                <a th:href="@{'/commandes/modifier/' + ${commande.id}}" class="btn btn-primary btn-sm">
                    ‚úèÔ∏è Modifier
                </a>
                <a th:href="@{'/commandes/supprimer/' + ${commande.id}}"
                   class="btn btn-danger btn-sm"
                   onclick="return confirm('Voulez-vous vraiment supprimer cette commande ?');">
                    üóëÔ∏è Supprimer
                </a>
                <!-- Bouton Valider seulement si la commande n'est pas valid√©e -->
                <a th:if="${commande.statut != 'VALIDEE'}"
                   th:href="@{'/commandes/valider/' + ${commande.id}}"
                   class="btn btn-success btn-sm">
                    ‚úÖ Valider
                </a>
                <!-- Bouton gris√© si d√©j√† valid√©e -->
                <button th:if="${commande.statut == 'VALIDEE'}" class="btn btn-secondary btn-sm" disabled>
                    ‚úÖ Valid√©e
                </button>
            </td>
        </tr>
        </tbody>
    </table>
</div>

</body>
</html>
